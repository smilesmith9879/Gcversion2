AI 智能四驱小车综合方案
2025 年 3 月 9 日 | 最终版

1. 项目概述
本项目基于 Raspberry Pi 5，结合 高精度摄像头、四驱底盘、无刷电机 + PID 速度控制、视觉 SLAM、语音交互 及 Web 远程控制，打造一款支持 智能导航 和 实时交互 的 AI 小车。

核心功能
✅ Web 控制：基于 WebSocket + Flask API 实现远程遥控，支持 虚拟摇杆 操作小车及摄像头云台。
✅ 实时视频传输：使用 WebRTC + 幻尔广角摄像头，支持 低延迟高清视频流。
✅ 语音交互：集成 Whisper + Ollama + DeepSeekR1 1.5B，支持 本地语音识别与智能回复。
✅ 无刷电机 + PID 控制：通过 ODrive/VESC 控制无刷电机，结合 编码器反馈 + PID 调节 实现精准速度控制。
✅ AI 自主导航：单目摄像头，结合 ORB-SLAM 2，实现 实时环境建图 & 路径规划。
✅ 文本转语音（TTS）：小车 自动朗读 DeepSeekR1 的回复，支持 中英文，并可调节音量及语速。
✅ 集成 ROS 2 + Nav2，让小车实现 自主导航 & 避障。


2. 硬件结构
组件	推荐型号	功能描述
计算单元	Raspberry Pi 5	控制小车运动、语音交互、Web 端
摄像头	HUANER USB 160° 4K	1920*1080P MJPG分辨率，支持夜视
车体底盘	LOBOT 四驱底盘	支持 前进、后退、转向、横向移动
电机驱动	ODrive/VESC + BLDC 电机	无刷电机 + 编码器反馈 + PID 速度控制
伺服云台	MG996R + PCA9685	水平旋转 ±45°（初始 80°），垂直旋转 ±45°（初始 40°）
语音处理	ReSpeaker 2-Mic / 4-Mic	语音识别及麦克风阵列
扬声器	USB 音箱	负责 TTS 输出，支持 pyttsx3 / espeak
3. 软件系统
操作系统：Ubuntu Server 24.04 LTS
核心控制程序：LOBOROBOT.py（控制小车运动 & 传感器输入）
AI 处理：ai_assistant.py（负责 Whisper 语音识别 & DeepSeekR1 处理）
语音合成：speech.py（基于 pyttsx3 + espeak 的 TTS 朗读）
Web 前端：Flask + WebRTC + WebSocket + JavaScript 控制页面
4. Web 控制界面设计
📌 UI 交互优化
双摇杆布局（移动端横屏模式）

左摇杆 控制 小车前进、后退、左右转向。
右摇杆 控制 摄像头云台旋转（上、下、左、右）。
摇杆居中归位：释放时，自动回到中心，并发送 停止指令。
自动调整转向速度：左/右转向时，速度自动降低至 正常速度的 50%。

全屏适配，可自动调整大小，保证最佳显示效果。
增强 HUD 设计，叠加 速度、方向、摄像头角度 信息。
底部交互区域

🎤 语音按钮（已优化 Safari 支持）
长按激活语音识别，可直接控制小车或摄像头。
兼容 Google Chrome & Apple Safari，修复权限问题。
📜 文本输入框（古风卷轴样式）
支持直接输入命令与 AI 交互（例如："前进 3 秒"）。
🔊 语音朗读
DeepSeekR1 回复 自动朗读，可调节音量 & 语速，支持 中英文。
5. 主题风格
配色方案：神秘蓝、青铜、金色，结合 古代符文 元素。
按钮风格：古代符文按钮，带 柔和发光动画。
背景纹理：低对比度 神庙壁画，增强 UI 层次感。
6. 关键优化点
✅ 远程控制 & Safari 兼容性
修复 iOS Safari 语音权限问题：

新增 设置按钮，允许用户手动触发权限请求。
HTTPS 检测，未使用 HTTPS 时 禁用语音按钮 并提示错误信息。
增强 WebRTC 视频传输：

优化带宽占用，减少卡顿，提高低延迟传输效果。
✅ AI & 语音交互
AI 启动时自动语音提示：

当 DeepSeekR1 启动完成，自动朗读 “Hello, I am ready”。
同时在聊天框显示，提示用户 AI 可用。
TTS 朗读增强：

支持中文朗读，并自动识别语言（langid.detect）。
优化朗读效果：增加音量，降低语速，提高清晰度。
✅ 小车运动控制
无刷电机 + PID 控制（已改进）：

通过 ODrive + 编码器反馈，动态调整 PWM 实现精准速度控制。
优化 PID 参数，确保 平稳启动 & 低速精准控制。
自动转向速度调整：

右/左转向时，自动降低速度 至 70%，保证稳定性。
优化摇杆操作：

摇杆归位时发送“停止”指令，防止误操作。


